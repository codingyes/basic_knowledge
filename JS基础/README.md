# JS基础
## 单线程的JS是如何实现异步的？

https://juejin.cn/post/6844904159385223175

核心：浏览器是多线程的。

### 浏览器执行js代码的过程
* 执行全局js代码，形成一个执行栈
* 当执行代码遇到异步任务时，会将宏任务加入宏任务队列，微任务加入微任务队列。
* 回调函数放入任务队列后不是立即执行，而是会等待执行栈中的同步任务执行完成后，才会去任务队列检查是否有任务。如果有则会将这些任务加入执行栈，然后执行。
* 先检查微任务队列是否有任务，如果这期间产生了新的微任务，则加入到队列末尾，直到微任务队列全部清空。再去检查宏任务队列是否有任务，有就加入到执行栈中。如果产生了微任务，则当前任务栈清空后会去检查微任务队列。直到宏任务和微任务队列都为空。

### H5 WebWorker
通过使用Web Workers，Web应用程序可以在独立于主线程的后台线程中，运行一个脚本操作。这样做的好处是可以在独立线程中执行费时的处理任务，从而允许主线程（通常是UI线程）不会因此被阻塞/放慢。

WebWorker是向浏览器申请一个子线程，该子线程服务于主线程，完全受主线程控制。